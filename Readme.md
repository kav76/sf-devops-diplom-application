## Описание

Здесь находится исходный код демонстрационного приложения и средства автоматизации его развертывания в рабочей среде.

Приложение представляет собой каталог с исходным кодом на языке `Python`. В среде выполнения работает в виде двух контейнеров - один с самим приложением, второй с базой данных `PostgreSQL`.
В процессе развертывания собирается новый `Docker` образ, помещается в репозиторий [Docker Hub](https://hub.docker.com) и затем на кластере `Kubernetes` с помощью `Helm chart` разворачивается и запускается приложение из образа, взятого из [Docker Hub](https://hub.docker.com).
Запуск процесса сборки docker образа и развертывания приложения происходит полностью автоматически при обновлении файлов в этом репозитории. 

## Содержимое репозитория
- `/app` - исходный код демонстрационного приложения.
- `/helm` - Helm chart для развертывания приложения на кластере `Kubernetes`. Предназначен для запуска из [Jenkins](https://www.jenkins.io/).
- `/screenshots` - скриншоты настройки `Jenkins`.
- `inventory` - файл с адресами серверов, где будет разворачиваться приложение.
- `Dockerfile` - манифест для сборки docker образа демонстрационного приложения.
- `requirements.txt` - приложения, необходимые для сборки образа docker.
- `vaulted_vars.vlt` - зашифрованный с помощью `Ansible Vault` файл с паролями.
- `ansible.cfg` - файл конфигурации `Ansible`.
- `build_container_playbook.yml` - файл описания заданий автоматизированного расвертывания приложения для `Ansible`. Адаптирован для запуска из [Jenkins](https://www.jenkins.io/).

## Предварительная настройка
1. С сервера управления открыть `Jenkins` в любом браузере - http://management.local:8080/. Адреса серверов рекомендуется настроить в файле /etc/hosts в соответствии с результатами установки серверов (см. [Руководство по установке](https://github.com/kav76/sf-devops-diplom-deployment/blob/main/Readme.md)).
2. Установить плагин `Ansible` (см. [Страницу плагина](https://plugins.jenkins.io/ansible/)). 
3. Настроить задание в соответсвии со скриншотами из каталога `/screenshots`
4. Настроить webhook с репозиторием `GihHub` (см. [Руководство](https://docs.github.com/en/webhooks)).

## Установка приложения
Внесите изменения в код и поместите его в данный репозиторий. Процесс установки запустится автоматически.